<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>컴포넌트화 시킨 방법</title>
<!-- BootStrap -->
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

<!-- jQuery library -->
<script
	src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.slim.min.js"></script>

<!-- Popper JS -->
<script
	src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- Vue -->
<script src="https://cdn.jsdelivr.net/npm/vue@2.7.14/dist/vue.js"></script>
<!-- JQuery -->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

<script>
	let app1;
	
	// 1) 재사용성이 있는 디자인 단위의 묶음인 컴포넌트 정의
	// 컴포넌트화는 JS의 객체 선언 방법을 이용... ES6 class
	// 추후 Row 태그 형식으로 불러 사용할 수 있다
	const Row={
		// 6) html에서 썼던거라 {{}} 쓸 수 있지만 여기 있는 애들이 바라보는건 data임
		// 멤버변수인 idx를 변수로 인식시키기 위해서는 그냥 onClick으로 처리하면 안되고 
		// Vue.js의 메서드 호출을 해야 하므로 v-on:click 으로 처리하자
		template : `
			<tr>
				<td><a href="#" v-on:click="getDetail(idx)">{{idx}}</a></td>
				<td>{{name}}</td>
			</tr>
		`
		// 4) 외부에 있는거 받아오기(props) : 홑따옴표 안에 (내맘대로)명칭으로 받아올 수 있음
		// <row/>가 props에 전달
		// props : 외부에서 전달된 태그의 속성을 받는 역할까지만
		, props : ['category_idx', 'category_name']
		// 5) 보관은 data에 하는거임 {}줘서 함수화
		// 이 인스턴스는 모두가 공유하기 때문에 새로운 인스턴스마다 새롭게 할당하기 위해 return 필요
		, data() { // data는 멤버변수로 보면 됨
			return {
				// 키 : 값(properties)
				 idx : this.category_idx, // 키 값이 멤버변수와 같으면 구분 못함
				 name : this.category_name
			};
		},
		methods: {
			getDetail:function(category_idx) {
				// 전역함수 땡겨올 수 있다
				getCategory(category_idx);
			}
		}
	}
	function init() {
		// 2) 뷰 인스턴스를 정의하면서 컴포넌트에 대한 설정도 함께 해보자
		app1 = new Vue({
			el:"#app1",
			components : {
				"row" : Row // Row라는 컴포넌트는 앞으로 <row/>라는 태그로 사용할 예정
			},
			data: {
				categoryList:[], 
				name : "zino" // (변수 : 값)
				
			}
		});
	}
	// 3) categoryList 받아오기
	function getCategoryList() {
		$.ajax({
			url:"/vue/category.jsp",
			type:"GET",
			success : function (result, status, xhr) {
				console.log(result);
				app1.categoryList = result;
			}
		});
	}
	function getCategory(category_idx) {
		alert(category_idx+" 약육강식");
	}
	$(function() {
		init();
		$("#bt_load").click(function() {
			getCategoryList();
		});
	});
</script>
</head>

<body>
	<div class="container" id="app1">
		<button id="bt_load">불러오기</button>
		<br>

		<table class="table">
			<thead class="thead-dark">
				<tr>
					<th>category_idx</th>
					<th>category_name</th>
				</tr>
			</thead>
			<tbody>
				<!-- <template v-for="i in 10"> -->
				<!-- <template v-for="i in categoryList"> -->
				<template v-for="category in categoryList">
				<!-- <row category_idx="7" category_name="지갑"/>-->
					<!-- <row category_idx="category.category_idx" category_name="category_name"/> -->
					<!-- 위처럼 넣으면 문자로 나와서 JSON을 인식못함 JSON쓰려면 대괄호 필요 -->
					<row v-bind:category_idx="category['category_idx']" v-bind:category_name="category['category_name']"/>
				</template>
			</tbody>
		</table>
	</div>
</body>

</html>