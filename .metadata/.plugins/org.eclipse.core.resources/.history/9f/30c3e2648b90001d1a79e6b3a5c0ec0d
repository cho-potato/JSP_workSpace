package gallery.servlet;

import java.io.File;
import java.io.IOException;

import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.oreilly.servlet.MultipartRequest;

// 이미지 파일을 포함한 글 수정
public class EditServlet extends HttpServlet{
	ServletContext context; // JSP에선 application 내장객체
	int maxSize = 1024*(1024*5); // 최대 파일 사이즈 
	String savePath; // 저장될 경로
		
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		context = request.getServletContext();
		
		savePath = context.getRealPath("/data/");
		
		// 생성자 호출에 의해 이미 업로드 완료
		MultipartRequest multi = new MultipartRequest(request, savePath, maxSize, "UTF-8");
		String gallery_idx = multi.getParameter("gallery_idx");
		String title = multi.getParameter("title");
		String writer = multi.getParameter("writer");
		String content = multi.getParameter("content");
		String filename = multi.getParameter("filename");
		
		// 1) 파일 삭제
		File file  = new File(savePath+filename);
		if(file.delete()) {
			// 2) 이미 업로드 된 이미지명을 rename 처리
			
		}
	}
}
